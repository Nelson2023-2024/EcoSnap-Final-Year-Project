generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  user_id            String          @id @default(uuid())
  user_firstName     String?
  user_lastName      String?
  user_fullName      String?
  user_email         String          @unique
  user_username      String          @unique
  user_phoneNumber   String?
  user_password      String?
  user_profileImage  String?         @default("https://cdn-icons-png.flaticon.com/512/149/149071.png")
  user_points        Int             @default(0)
  user_googleID      String?         @unique
  user_authProvider  String?
  user_role          UserRole        @default(user)
  user_createdAt     DateTime        @default(now())
  user_updatedAt     DateTime        @updatedAt
  user_assignedTeams TeamMember[]
  user_wasteReports  WasteAnalysis[]

  @@map("users")
}

model Team {
  team_id             String             @id @default(uuid())
  team_name           String
  team_url            String?
  team_specialization TeamSpecialization @default(general)
  team_status         TeamStatus         @default(active)
  team_createdAt      DateTime           @default(now())
  team_updatedAt      DateTime           @updatedAt
  team_members        TeamMember[]
  team_trucks         Truck[]

  @@map("teams")
}

model TeamMember {
  id     String @id @default(uuid())
  userId String
  teamId String
  team   Team   @relation(fields: [teamId], references: [team_id], onDelete: Cascade)
  user   User   @relation(fields: [userId], references: [user_id], onDelete: Cascade)

  @@unique([userId, teamId])
  @@map("team_members")
}

model Truck {
  truck_id                 String      @id @default(uuid())
  truck_registrationNumber String      @unique
  truck_imageURL           String?
  truck_truckType          TruckType
  truck_capacity           Float
  truck_status             TruckStatus @default(available)
  truck_assignedTeamId     String?
  truck_locationLongitude  Float       @default(0)
  truck_locationLatitude   Float       @default(0)
  truck_createdAt          DateTime    @default(now())
  truck_updatedAt          DateTime    @updatedAt
  truck_assignedTeam       Team?       @relation(fields: [truck_assignedTeamId], references: [team_id])

  @@map("trucks")
}

model WasteAnalysis {
  waste_id                    String                @id @default(uuid())
  waste_analysedBy            String
  waste_imageURL              String
  waste_containsWaste         Boolean               @default(true)
  waste_overallCategory       WasteOverallCategory?
  waste_dominantWasteType     String?
  waste_estimatedVolumeValue  Float?
  waste_estimatedVolumeUnit   VolumeUnit?
  waste_possibleSource        String?               @db.Text
  waste_environmentalImpact   String?               @db.Text
  waste_confidenceLevel       String?
  waste_status                WasteStatus           @default(pending_dispatch)
  waste_errorMessage          String?               @db.Text
  waste_locationLongitude     Float
  waste_locationLatitude      Float
  waste_locationAddress       String?
  waste_createdAt             DateTime              @default(now())
  waste_updatedAt             DateTime              @updatedAt
  waste_wasteCategories       WasteCategory[]
  waste_user                  User                  @relation(fields: [waste_analysedBy], references: [user_id], onDelete: Cascade)

  @@map("waste_analysis")
}

model WasteCategory {
  id                         String        @id @default(uuid())
  waste_type                 String
  waste_estimatedPercentage  Float
  wasteAnalysisId            String
  wasteAnalysis              WasteAnalysis @relation(fields: [wasteAnalysisId], references: [waste_id], onDelete: Cascade)

  @@map("waste_categories")
}

enum UserRole {
  user
  admin
  collector
}

enum TeamSpecialization {
  general
  recyclables
  e_waste
  organic
  hazardous

  @@map("team_specialization")
}

enum TeamStatus {
  active
  off_duty

  @@map("team_status")
}

enum TruckType {
  general
  recyclables
  e_waste
  organic
  hazardous

  @@map("truck_type")
}

enum TruckStatus {
  available
  in_use
  maintenance

  @@map("truck_status")
}

enum WasteOverallCategory {
  general
  recyclables
  e_waste
  organic
  hazardous

  @@map("waste_overall_category")
}

enum VolumeUnit {
  kg
  liters
  cubic_meters

  @@map("volume_unit")
}

enum WasteStatus {
  pending_dispatch
  dispatched
  collected
  no_waste
  error

  @@map("waste_status")
}